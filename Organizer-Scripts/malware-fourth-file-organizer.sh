#!/bin/bash

find /root/MOS-tpot/Malware-Files/Files/Raw-Executables/ -ls  | while read line
  do
    fileName=$(echo $line | awk '{ print $11}')
    rawExec=$(file "$fileName" 2>/dev/null)

    if [[ "$rawExec" == *"ELF 32-bit LSB executable"* ]] && [[ "$rawExec" == *"Intel"* ]] && [[ "$rawExec" == *"statically linked"* ]] && [[ "$rawExec" == *"not stripped"* ]];
    then
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Raw-Executables/LSB-EXEs/Non-Stripped-ELFs/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Executables....ELF LSB Found!"
#    echo "I'm an Intel based ELF LSB that is staticallly linked and not stripped"

    elif [[ "$rawExec" == *"ELF 32-bit LSB executable"* ]] && [[ "$rawExec" == *"ARM"* ]] && [[ "$rawExec" == *"EABI5"* ]] && [[ "$rawExec" == *"statically linked"* ]] && [[ "$rawExec" == *"stripped"* ]];
    then
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Raw-Executables/LSB-EXEs/Stripped-ELFs/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Executables....ELF LSB Found!"
#    echo "I'm an ARM EABI5 based ELF LSB that is statically linked and is stripped"

    elif [[ "$rawExec" == *"ELF 32-bit LSB executable"* ]] && [[ "$rawExec" == *"ARM"* ]] && [[ "$rawExec" == *"version 1"* ]] && [[ "$rawExec" == *"statically linked"* ]] && [[ "$rawExec" == *"stripped"* ]];
    then
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Raw-Executables/LSB-EXEs/Stripped-ELFs/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Executables....ELF LSB Found!"
#    echo "I'm an ARM version 1 based ELF LSB that is statically linked and is stripped"

    elif [[ "$rawExec" == *"ELF 32-bit LSB executable"* ]] && [[ "$rawExec" == *"MIPS"* ]] && [[ "$rawExec" == *"MIPS-I"* ]] &&  [[ "$rawExec" == *"statically linked"* ]] && [[ "$rawExec" == *"stripped"* ]];
    then
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Raw-Executables/LSB-EXEs/Stripped-ELFs/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Executables....ELF LSB Found!"
#    echo "I'm an MIPS based ELF LSB that is statically linked and is stripped"

    elif [[ "$rawExec" == *"ELF 64-bit LSB executable"* ]] && [[ "$rawExec" == *"x86-64"* ]] && [[ "$rawExec" == *"version 1"* ]] && [[ "$rawExec" == *"statically linked"* ]] && [[ "$rawExec" == *"stripped"* ]];
    then
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Raw-Executables/LSB-EXEs/Stripped-ELFs/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Executables....ELF LSB Found!"


    elif [[ "$rawExec" == *"ELF 32-bit MSB executable"* ]] && [[ "$rawExec" == *"SPARC"* ]] && [[ "$rawExec" == *"version 1"* ]] &&  [[ "$rawExec" == *"statically linked"* ]] && [[ "$rawExec" == *"stripped"* ]];
    then
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Raw-Executables/MSB-EXEs/Stripped/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Executables....ELF MSB Found!"
#    echo "I'm an SPARC based ELF MSB that is statically linked and is stripped"

    elif [[ "$rawExec" == *"ELF 32-bit MSB executable"* ]] && [[ "$rawExec" == *"MIPS"* ]] && [[ "$rawExec" == *"MIPS-I"* ]] && [[ "$rawExec" == *"statically linked"* ]] && [[ "$rawExec" == *"stripped"* ]];
    then
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Raw-Executables/MSB-EXEs/Stripped/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Executables....ELF MSB Found!"
#    echo "I'm an SPARC based ELF MSB that is statically linked and is stripped"

    elif [[ "$rawExec" == *"OpenSSH RSA"* ]];
    then
    echo "I'm a stupid OpenSSH Key"

    else
#    cp $fileName /root/MOS-tpot/Malware-Files/Files/Crypto-Miners/Unidentified-Miners/ > /dev/null 2>&1
#    rm $fileName > /dev/null 2>&1 | echo "Organizing found Crypto-Miners...Unknown Signature Detected"
    echo "I'm something else"

    fi

done
